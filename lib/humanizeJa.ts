// lib/humanizeJa.ts - AIっぽさを除去する人肌フィルタ

export function humanizeJa(text: string): string {
  // AIでよく使われるフレーズを自然な表現に置換
  const banPhrases = [
    { re: /本記事では/g, rep: '今日は' },
    { re: /について解説します/g, rep: 'の話をしよう' },
    { re: /いかがでしたか？/g, rep: 'どう思う？' },
    { re: /まとめ(です。|です|。)?\s*$/gm, rep: '最後にひとこと' },
    { re: /ぜひ(.{0,12})してみてください/g, rep: 'まずは$1やってみよう' },
    { re: /と言えるでしょう/g, rep: 'って言える' },
    { re: /重要です/g, rep: '大事' },
    { re: /していきます/g, rep: 'します' },
    { re: /〜について説明します/g, rep: '〜の話です' },
    { re: /ご紹介します/g, rep: '紹介しよう' },
    { re: /確認してみてください/g, rep: 'チェックしてみよう' },
    { re: /参考にしてください/g, rep: '参考にしてね' },
    { re: /理解していただけたでしょうか/g, rep: '分かったかな' },
    { re: /検討してみてください/g, rep: '考えてみて' },
    { re: /活用してみてください/g, rep: '使ってみよう' },
  ];
  
  let output = text;
  
  // 禁止フレーズを自然な表現に置換
  for (const {re, rep} of banPhrases) {
    output = output.replace(re, rep);
  }
  
  // 同じ語尾の連続を自然にバラす
  output = output.replace(/です。です。です。/g, 'です。ですよ。です。');
  output = output.replace(/ます。ます。ます。/g, 'ます。ますね。ます。');
  output = output.replace(/でしょう。でしょう。/g, 'でしょう。だと思います。');
  
  // 過度に丁寧な表現を自然に
  output = output.replace(/させていただきます/g, 'します');
  output = output.replace(/させていただく/g, 'する');
  
  return output;
}

// 声質プロンプトのテンプレート（日本語フレンドリーカジュアル）
export const VOICE_PROMPT_JA_FRIEND_CASUAL = `あなたはプロのライターです。以下の"声質"で出力してください。

[声質/JA-friend-casual]
- 口調: 親しい友人に話すようなフレンドリーで自然な口語体。少しユーモア。
- 難易度: 高校生にもわかる平易さ。専門用語はかみ砕く。
- 表現: 具体例や比喩を1つは入れる。結論→理由→行動の順。
- 禁止: 「本記事では」「〜について解説します」「いかがでしたか？」「まとめ」
        「ぜひ〜してみてください」「と言えるでしょう」「重要です」「〜していきます」
- 文リズム目安: 一文20〜40字中心。ときどき短文で間を作る。`;

// その他の声質バリエーション
export const VOICE_PROMPT_JA_PROFESSIONAL = `あなたはプロのライターです。以下の"声質"で出力してください。

[声質/JA-professional]
- 口調: 信頼感のある専門的な文体。丁寧だが親しみやすい。
- 難易度: ビジネスパーソン向け。専門用語は適度に使用し説明も添える。
- 表現: データや事例を重視。論理的な構成で説得力を重視。
- 禁止: 「本記事では」「〜について解説します」「いかがでしたか？」
        「ぜひ〜してみてください」「と言えるでしょう」「〜していきます」
- 文リズム目安: 一文30〜50字。構造化された文章。`;

export const VOICE_PROMPT_JA_SIMPLE = `あなたはプロのライターです。以下の"声質"で出力してください。

[声質/JA-simple]
- 口調: 誰でも読みやすい平易な文体。温かみのある表現。
- 難易度: 中学生でも理解できる簡潔さ。難しい言葉は使わない。
- 表現: 身近な例えと具体的な説明。「〜ですよ」「〜ですね」の親近感。
- 禁止: 「本記事では」「〜について解説します」「いかがでしたか？」
        「ぜひ〜してみてください」「重要です」「〜していきます」
- 文リズム目安: 一文15〜25字。短くテンポよく。`;

// デフォルトの声質（フレンドリーカジュアル）
export const DEFAULT_VOICE_PROMPT = VOICE_PROMPT_JA_FRIEND_CASUAL;